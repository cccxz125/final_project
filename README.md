# 二維布朗運動模擬與視覺化分析

本專案為計算機程式課程之期末專題，利用 Python 模擬二維布朗運動（Brownian Motion），並透過數值計算與視覺化方式，分析粒子在封閉空間中的擴散行為。
本程式結合隨機遊走模型、邊界反射機制與統計分析，呈現布朗運動的動態與其物理特性。

---

(1) 程式的原理與功能

1. 數學與物理原理說明

布朗運動是指微小粒子在流體中，受到周圍分子不規則碰撞而產生的隨機運動。在理論模型中，常將其簡化為「隨機遊走（Random Walk）」問題。

在本程式中，每一個粒子在每一個時間步都會隨機選擇一個方向前進，其位置更新方式如下：

x(t) = x(t−1) + ΔL · cos(θ)  
y(t) = y(t−1) + ΔL · sin(θ)

其中：  
- ΔL 為每一步的位移長度（步長）  
- θ 為介於 0 到 2π 之間的隨機角度  


2. 均方位移（Mean Squared Displacement, MSD）

為了量化粒子的擴散程度，本程式計算均方位移（MSD），其概念為：  
「所有粒子在時間 t 時，與初始位置距離平方的平均值」。

計算方式可表示為：

MSD(t) = (1 / N) × 所有粒子在時間 t 的位移平方總和  

其中：  
- N 為粒子總數  
- 位移平方為 (x(t) − x(0))² + (y(t) − y(0))²  

在理想的無邊界空間中，MSD 會隨時間近似線性成長，這也是判斷是否為正常擴散行為的重要依據。


3. 程式功能說明

- 模擬 50 個粒子在二維空間中的隨機運動  
- 加入封閉容器邊界，模擬粒子與牆面之完全彈性碰撞  
- 繪製粒子運動軌跡與 MSD 隨時間變化圖  
- 使用動畫方式即時呈現粒子動態行為  

---

(2) 使用方式

1. 環境需求  
   需安裝 Python 3，並確保已安裝以下套件：  
   - numpy  
   - matplotlib  

2. 執行方式
   在終端機或命令列中執行

3. 執行流程說明 
- 程式執行後會先顯示粒子靜態軌跡圖與 MSD 統計圖  
- 關閉靜態圖視窗後，會自動啟動布朗運動的動態模擬動畫  

4. 參數調整  
程式中部分模擬參數（如粒子數量、模擬步數與步長設定等）集中定義於程式開頭，方便在實驗時進行不同條件的測試，這些參數會影響模擬的統計穩定度與擴散結果。
---

(3) 程式的架構

整體程式架構依照物理模擬流程進行設計，主要可分為以下模組：

1. 參數初始化模組： 
設定粒子數量、模擬時間步數與空間邊界大小。

2. 隨機位移計算模組： 
使用 NumPy 產生隨機角度，並以向量化方式計算所有粒子的 x 與 y 位移，對應隨機遊走模型。

3. 邊界反射模組：  
當粒子超出容器邊界時，利用座標鏡射的方式修正位置，使粒子回到容器內，模擬完全彈性碰撞。

4. 統計分析模組：  
於每一時間步計算所有粒子的平均平方位移（MSD），用以分析擴散行為。

5. 視覺化模組：
使用 Matplotlib 繪製靜態圖表，並透過 FuncAnimation 實作即時動畫。

---

(4) 開發過程

在程式撰寫過程中，主要遇到以下幾個問題：

- 邊界處理問題 
初期粒子會直接跑出畫面，後來我自行設計邊界反射邏輯，透過超出距離的鏡射修正，成功模擬粒子撞牆後反彈的行為。

- 動畫效能不足  
一開始以 for 迴圈逐一更新粒子位置，動畫播放明顯卡頓。後來改用 NumPy 向量化運算，一次更新所有粒子的座標，大幅改善效能。

- 中文字體顯示異常  
在 Mac 系統上，Matplotlib 預設字體無法正常顯示中文，後來透過設定 Arial Unicode MS 字體解決標題與標籤亂碼問題。

---

(5) 參考資料來源

- Wikipedia：Brownian Motion、Random Walk 相關理論說明  
- Matplotlib 官方文件：FuncAnimation 動畫模組使用方式  
- NumPy 官方文件：矩陣與向量化運算說明  
- ChatGPT（OpenAI）：協助理解布朗運動模型、提供基礎程式結構與除錯方向參考  

---

(6) 程式修改與增強的內容

本程式在參考 ChatGPT 所提供的基礎概念後，進行了以下修改與擴充，屬於我自行完成的部分：

1. 邊界反射機制的完整實作
原始範例僅處理無邊界情況，我自行撰寫邊界檢查與反射座標計算，使粒子能在封閉容器中持續運動。

2. 加入溫度參數與步長連動  
將溫度作為控制變因，讓步長隨能量大小改變，使模擬結果更貼近物理直覺。

3. MSD 統計分析功能擴充  
主動加入均方位移的計算與繪圖，使程式不僅是動畫展示，也能用數據方式驗證擴散行為。
